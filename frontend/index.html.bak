<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RoBERTa Sentiment Analysis | GenAI-L√∂sung</title>
    
    <!-- Google Fonts - Similar to red6's clean typography -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            /* red6 Color Palette */
            --red6-primary: #E30613;      /* red6 red */
            --red6-dark: #1a1a1a;         /* Dark gray */
            --red6-text: #2d2d2d;         /* Text color */
            --red6-light-gray: #f5f5f5;   /* Light background */
            --red6-medium-gray: #6b7280;  /* Secondary text */
            --red6-white: #ffffff;
            --red6-blue: #0066cc;         /* Accent blue */
            --red6-success: #10b981;
            --red6-warning: #f59e0b;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            line-height: 1.6;
            color: var(--red6-text);
            background: var(--red6-white);
        }
        
        /* Header - red6 style */
        header {
            background: var(--red6-white);
            border-bottom: 1px solid #e5e7eb;
            padding: 1rem 0;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            height: 75px;
            width: auto;
        }
        
        nav {
            display: flex;
            gap: 2rem;
            align-items: center;
        }
        
        nav a {
            color: var(--red6-text);
            text-decoration: none;
            font-weight: 500;
            font-size: 0.95rem;
            transition: color 0.3s;
        }
        
        nav a:hover {
            color: var(--red6-primary);
        }
        
        /* Hero Section - red6 style */
        .hero {
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            color: var(--red6-white);
            padding: 4rem 0;
            text-align: center;
        }
        
        .hero h1 {
            font-family: 'Poppins', sans-serif;
            font-size: 2.8rem;
            font-weight: 700;
            margin-bottom: 1rem;
            line-height: 1.2;
        }
        
        .hero .subtitle {
            font-size: 1.25rem;
            color: #d1d5db;
            margin-bottom: 0.5rem;
            font-weight: 300;
        }
        
        .hero .tech-badge {
            display: inline-block;
            background: rgba(227, 6, 19, 0.2);
            color: var(--red6-primary);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.875rem;
            font-weight: 600;
            margin-top: 1rem;
        }
        
        /* Form Section */
        .form-section {
            background: var(--red6-light-gray);
            padding: 3rem 0;
        }
        
        .form-card {
            background: var(--red6-white);
            border-radius: 12px;
            padding: 2.5rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.07);
            max-width: 800px;
            margin: 0 auto;
        }
        
        .form-section h2 {
            font-family: 'Poppins', sans-serif;
            color: var(--red6-dark);
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }
        
        .form-section .subtitle {
            color: var(--red6-medium-gray);
            margin-bottom: 2rem;
            font-size: 1.05rem;
        }
        
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        label {
            display: block;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--red6-dark);
            font-size: 0.95rem;
        }
        
        input[type="text"],
        input[type="email"],
        select,
        textarea {
            width: 100%;
            padding: 0.875rem 1rem;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 1rem;
            font-family: inherit;
            transition: all 0.3s;
        }
        
        input:focus,
        select:focus,
        textarea:focus {
            outline: none;
            border-color: var(--red6-primary);
            box-shadow: 0 0 0 3px rgba(227, 6, 19, 0.1);
        }
        
        textarea {
            resize: vertical;
            min-height: 100px;
        }
        
        .btn {
            background: var(--red6-primary);
            color: var(--red6-white);
            padding: 1rem 2.5rem;
            border: none;
            border-radius: 8px;
            font-size: 1.05rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-block;
            text-decoration: none;
        }
        
        .btn:hover {
            background: #c10511;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(227, 6, 19, 0.3);
        }
        
        .btn:disabled {
            background: #9ca3af;
            cursor: not-allowed;
            transform: none;
        }
        
        /* Features Section - red6 style */
        .features {
            padding: 4rem 0;
            background: var(--red6-white);
        }
        
        .features h2 {
            font-family: 'Poppins', sans-serif;
            text-align: center;
            font-size: 2rem;
            margin-bottom: 3rem;
            color: var(--red6-dark);
        }
        
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 2rem;
        }
        
        .feature-card {
            background: var(--red6-light-gray);
            padding: 2rem;
            border-radius: 12px;
            transition: transform 0.3s;
        }
        
        .feature-card:hover {
            transform: translateY(-5px);
        }
        
        .feature-icon {
            width: 50px;
            height: 50px;
            background: var(--red6-primary);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 1rem;
            font-size: 1.5rem;
        }
        
        .feature-card h3 {
            font-size: 1.25rem;
            margin-bottom: 0.75rem;
            color: var(--red6-dark);
        }
        
        .feature-card p {
            color: var(--red6-medium-gray);
            line-height: 1.6;
        }
        
        /* Progress Section */
        .progress-section {
            background: var(--red6-light-gray);
            padding: 2rem 0;
            display: none;
        }
        
        .progress-card {
            background: var(--red6-white);
            border-radius: 12px;
            padding: 2rem;
            max-width: 600px;
            margin: 0 auto;
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e5e7eb;
            border-radius: 10px;
            overflow: hidden;
            margin: 1rem 0;
        }
        
        .progress-fill {
            height: 100%;
            background: var(--red6-primary);
            transition: width 0.3s;
            border-radius: 10px;
        }
        
        .status-message {
            color: var(--red6-medium-gray);
            font-size: 0.95rem;
            margin-top: 0.5rem;
        }
        
        /* Footer - red6 style */
        footer {
            background: var(--red6-dark);
            color: var(--red6-white);
            padding: 3rem 0 2rem;
        }
        
        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }
        
        .footer-section h4 {
            font-size: 1.1rem;
            margin-bottom: 1rem;
            color: var(--red6-primary);
        }
        
        .footer-section a {
            display: block;
            color: #d1d5db;
            text-decoration: none;
            margin-bottom: 0.5rem;
            transition: color 0.3s;
        }
        
        .footer-section a:hover {
            color: var(--red6-white);
        }
        
        .footer-bottom {
            border-top: 1px solid #374151;
            padding-top: 2rem;
            text-align: center;
            color: #9ca3af;
            font-size: 0.9rem;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .hero h1 {
                font-size: 2rem;
            }
            
            nav {
                display: none;
            }
            
            .form-card {
                padding: 1.5rem;
            }
        }
        
        /* Chatbot Widget */
        .chatbot-trigger {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 60px;
            height: 60px;
            background: var(--red6-primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(227, 6, 19, 0.4);
            transition: all 0.3s;
            z-index: 1000;
        }
        
        .chatbot-trigger:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(227, 6, 19, 0.5);
        }
        
        .chatbot-trigger svg {
            width: 30px;
            height: 30px;
            fill: white;
        }
        
        .chatbot-window {
            position: fixed;
            bottom: 100px;
            right: 2rem;
            width: 380px;
            height: 500px;
            background: var(--red6-white);
            border-radius: 16px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            display: none;
            flex-direction: column;
            z-index: 1001;
            overflow: hidden;
        }
        
        .chatbot-window.active {
            display: flex;
        }
        
        /* Analysis Modal */
        .analysis-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }
        
        .analysis-modal.active {
            display: flex;
        }
        
        .modal-content {
            background: white;
            border-radius: 12px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            animation: slideIn 0.3s ease-out;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .modal-header {
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            color: white;
            padding: 1.5rem;
            border-radius: 12px 12px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-header h3 {
            margin: 0;
            font-size: 1.3rem;
        }
        
        .modal-close {
            background: none;
            border: none;
            color: white;
            font-size: 2rem;
            cursor: pointer;
            padding: 0;
            width: 35px;
            height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0.8;
            transition: opacity 0.2s;
        }
        
        .modal-close:hover {
            opacity: 1;
        }
        
        .modal-body {
            padding: 2rem;
        }
        
        .modal-progress {
            margin-bottom: 2rem;
        }
        
        .modal-progress h4 {
            margin: 0 0 1rem 0;
            color: #333;
        }
        
        .modal-progress-bar {
            background: #e0e0e0;
            border-radius: 10px;
            height: 20px;
            overflow: hidden;
            margin-bottom: 0.5rem;
        }
        
        .modal-progress-fill {
            background: linear-gradient(90deg, #4caf50 0%, #81c784 100%);
            height: 100%;
            transition: width 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 10px;
            color: white;
            font-size: 0.85rem;
            font-weight: bold;
        }
        
        .modal-status {
            color: #666;
            font-size: 0.95rem;
        }
        
        .results-summary {
            background: #f5f5f5;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }
        
        .results-summary h4 {
            margin: 0 0 1rem 0;
            color: #333;
        }
        
        .sentiment-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin-bottom: 1rem;
        }
        
        .sentiment-stat {
            text-align: center;
            padding: 1rem;
            background: white;
            border-radius: 6px;
            border: 2px solid #e0e0e0;
        }
        
        .sentiment-stat.positive {
            border-color: #4caf50;
        }
        
        .sentiment-stat.negative {
            border-color: #f44336;
        }
        
        .sentiment-stat.neutral {
            border-color: #9e9e9e;
        }
        
        .sentiment-stat .icon {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }
        
        .sentiment-stat .label {
            font-size: 0.85rem;
            color: #666;
            margin-bottom: 0.25rem;
        }
        
        .sentiment-stat .count {
            font-size: 1.5rem;
            font-weight: bold;
            color: #333;
        }
        
        .sentiment-stat .percentage {
            font-size: 0.9rem;
            color: #888;
        }
        
        .modal-actions {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
        }
        
        .modal-btn {
            flex: 1;
            padding: 0.9rem 1.5rem;
            border: none;
            border-radius: 6px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }
        
        .modal-btn.primary {
            background: var(--red6-primary);
            color: white;
        }
        
        .modal-btn.primary:hover {
            background: #c00000;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(227, 6, 19, 0.3);
        }
        
        .modal-btn.secondary {
            background: #2d2d2d;
            color: white;
        }
        
        .modal-btn.secondary:hover {
            background: #1a1a1a;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        
        .chatbot-header {
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            color: var(--red6-white);
            padding: 1.25rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .chatbot-header h3 {
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .chatbot-close {
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .chatbot-messages {
            flex: 1;
            overflow-y: auto;
            padding: 1.5rem;
            background: var(--red6-light-gray);
        }
        
        .chat-message {
            margin-bottom: 1rem;
            display: flex;
            gap: 0.75rem;
        }
        
        .chat-message.bot {
            flex-direction: row;
        }
        
        .chat-message.user {
            flex-direction: row-reverse;
        }
        
        .message-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            font-size: 1rem;
        }
        
        .chat-message.bot .message-avatar {
            background: var(--red6-primary);
            color: white;
        }
        
        .chat-message.user .message-avatar {
            background: var(--red6-dark);
            color: white;
        }
        
        .message-content {
            max-width: 75%;
            padding: 0.75rem 1rem;
            border-radius: 12px;
            line-height: 1.5;
            font-size: 0.95rem;
        }
        
        .chat-message.bot .message-content {
            background: var(--red6-white);
            color: var(--red6-text);
        }
        
        .chat-message.user .message-content {
            background: var(--red6-primary);
            color: white;
        }
        
        .chatbot-input {
            padding: 1rem;
            border-top: 1px solid #e5e7eb;
            background: var(--red6-white);
            display: flex;
            gap: 0.5rem;
        }
        
        .chatbot-input input {
            flex: 1;
            padding: 0.75rem;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 0.95rem;
        }
        
        .chatbot-input button {
            background: var(--red6-primary);
            color: white;
            border: none;
            padding: 0.75rem 1.25rem;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.3s;
        }
        
        .chatbot-input button:hover {
            background: #c10511;
        }
        
        @media (max-width: 768px) {
            .chatbot-window {
                width: calc(100vw - 2rem);
                right: 1rem;
                left: 1rem;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container">
            <div class="header-content">
                <img src="red6-logo.jpg" alt="red6 Logo" class="logo">
                <nav>
                    <a href="#features">Features</a>
                    <a href="#demo">Demo</a>
                    <a href="#contact">Kontakt</a>
                </nav>
            </div>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="hero">
        <div class="container">
            <p class="subtitle">GENERATIVE KI-L√ñSUNG</p>
            <h1>RoBERTa Sentiment Analysis<br/>f√ºr intelligente Kundeneinblicke</h1>
            <div class="tech-badge">ü§ñ Powered by DistilBERT & LLaMA</div>
        </div>
    </section>

    <!-- Analysis Form -->
    <section class="form-section" id="demo">
        <div class="container">
            <div class="form-card">
                <h2>Starten Sie Ihre Analyse</h2>
                <p class="subtitle">Analysieren Sie Kundenfeedback mit modernster KI-Technologie</p>
                
                <form id="analysisForm">
                    <div class="form-group">
                        <label for="companyName">Firmenname *</label>
                        <input type="text" id="companyName" name="companyName" 
                               placeholder="z.B. Awesome enterprise software GmbH" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="searchMethod">Analysemethode *</label>
                        <select id="searchMethod" name="searchMethod" required>
                            <option value="demo">Demo (Restaurant Reviews)</option>
                            <option value="url">Webseiten-URL analysieren</option>
                            <option value="keywords">Stichwortsuche</option>
                        </select>
                    </div>
                    
                    <div class="form-group" id="urlInputGroup" style="display:none;">
                        <label for="targetUrl">Ziel-URL</label>
                        <input type="text" id="targetUrl" name="targetUrl" 
                               placeholder="https://example.com/reviews">
                    </div>
                    
                    <div class="form-group" id="keywordsInputGroup" style="display:none;">
                        <label for="keywords">Suchbegriffe</label>
                        <input type="text" id="keywords" name="keywords" 
                               placeholder="z.B. Versicherung, Kundenservice">
                    </div>
                    
                    <div class="form-group">
                        <label for="email">E-Mail f√ºr Berichtszustellung *</label>
                        <input type="text" id="email" name="email" 
                               placeholder="ihre.awesome@red6-es.de oder mehrere durch Komma getrennt" 
                               pattern="[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}(\s*,\s*[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,})*"
                               title="Geben Sie eine oder mehrere E-Mail-Adressen ein, getrennt durch Kommas"
                               required>
                        <small style="color: #666; font-size: 0.85em; display: block; margin-top: 5px;">
                            üí° Mehrere E-Mails m√∂glich: email1@firma.de, email2@firma.de
                        </small>
                    </div>
                    
                    <div class="form-group">
                        <label for="customPrompt">Individuelle Analyseanforderungen (optional)</label>
                        <textarea id="customPrompt" name="customPrompt" 
                                  placeholder="Spezielle Aspekte, die Sie analysieren m√∂chten..."></textarea>
                    </div>
                    
                    <button type="submit" class="btn" id="submitBtn">
                        üöÄ Analyse starten
                    </button>
                </form>
            </div>
        </div>
    </section>

    <!-- Progress Section -->
    <!-- Analysis Modal -->
    <div class="analysis-modal" id="analysisModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>‚ö° Analyse l√§uft...</h3>
                <button class="modal-close" id="modalClose">√ó</button>
            </div>
            <div class="modal-body">
                <div class="modal-progress" id="modalProgress">
                    <h4>Fortschritt</h4>
                    <div class="modal-progress-bar">
                        <div class="modal-progress-fill" id="modalProgressFill" style="width: 0%">0%</div>
                    </div>
                    <p class="modal-status" id="modalStatus">Initialisierung...</p>
                </div>
                
                <div class="results-summary" id="resultsSummary" style="display: none;">
                    <h4>‚úÖ Analyse abgeschlossen</h4>
                    <div class="sentiment-stats">
                        <div class="sentiment-stat positive">
                            <div class="icon">üòä</div>
                            <div class="label">Positive</div>
                            <div class="count" id="positiveCount">0</div>
                            <div class="percentage" id="positivePercent">0%</div>
                        </div>
                        <div class="sentiment-stat negative">
                            <div class="icon">üòû</div>
                            <div class="label">Negative</div>
                            <div class="count" id="negativeCount">0</div>
                            <div class="percentage" id="negativePercent">0%</div>
                        </div>
                        <div class="sentiment-stat neutral">
                            <div class="icon">üòê</div>
                            <div class="label">Neutral</div>
                            <div class="count" id="neutralCount">0</div>
                            <div class="percentage" id="neutralPercent">0%</div>
                        </div>
                    </div>
                    
                    <div class="modal-actions">
                        <button class="modal-btn secondary" id="newAnalysisBtn">
                            üîÑ Weitere Analyse
                        </button>
                        <button class="modal-btn primary" id="downloadPdfBtn">
                            üì• PDF herunterladen
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Features Section -->
    <section class="features" id="features">
        <div class="container">
            <h2>Leistungsmerkmale unserer GenAI-L√∂sung</h2>
            <div class="feature-grid">
                <div class="feature-card">
                    <div class="feature-icon">üß†</div>
                    <h3>DistilBERT Sentiment-Klassifizierung</h3>
                    <p>Hochpr√§zise Analyse mit modernster Transformer-Architektur f√ºr zuverl√§ssige Sentiment-Erkennung</p>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">üìä</div>
                    <h3>Vektorsuch & Clustering</h3>
                    <p>TF-IDF Vektorisierung und K-means Clustering identifizieren repr√§sentative Kommentare</p>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">ü§ñ</div>
                    <h3>LLaMA-basierte Zusammenfassungen</h3>
                    <p>KI-generierte Insights und Handlungsempfehlungen durch leistungsstarke LLMs</p>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">üí∞</div>
                    <h3>Risikobewertung</h3>
                    <p>Automatische Berechnung von Insolvenzrisiken basierend auf Sentiment-Analysen</p>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">üìÑ</div>
                    <h3>Professionelle PDF-Berichte</h3>
                    <p>Umfassende Reports mit Visualisierungen, Trends und detaillierten Analysen</p>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">‚úâÔ∏è</div>
                    <h3>Automatische Zustellung</h3>
                    <p>Sofortige E-Mail-Benachrichtigung mit vollst√§ndigem Analysebericht</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>√úber das Projekt</h4>
                    <a href="#">RoBERTa Sentiment Analysis</a>
                    <a href="#">Technologie-Stack</a>
                    <a href="#">Dokumentation</a>
                </div>
                <div class="footer-section">
                    <h4>Services</h4>
                    <a href="#">GenAI-L√∂sungen</a>
                    <a href="#">Sentiment-Analyse</a>
                    <a href="#">Risikobewertung</a>
                </div>
                <div class="footer-section">
                    <h4>Kontakt</h4>
                    <a href="#">E-Mail senden</a>
                    <a href="https://red6-es.de" target="_blank">red6 Webseite</a>
                    <a href="https://github.com/Vlasenko2006" target="_blank">GitHub</a>
                </div>
            </div>
            <div class="footer-bottom">
                <p>¬© 2025 Sentiment Analysis Platform | Entwickelt mit red6 GenAI-Technologie</p>
            </div>
        </div>
    </footer>

    <!-- Chatbot Widget -->
    <div class="chatbot-trigger" id="chatbotTrigger">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H6l-2 2V4h16v12z"/>
            <circle cx="8" cy="10" r="1.5"/>
            <circle cx="12" cy="10" r="1.5"/>
            <circle cx="16" cy="10" r="1.5"/>
        </svg>
    </div>
    
    <div class="chatbot-window" id="chatbotWindow">
        <div class="chatbot-header">
            <h3>
                <span>ü§ñ</span>
                GenAI Assistent
            </h3>
            <button class="chatbot-close" id="chatbotClose">√ó</button>
        </div>
        <div class="chatbot-messages" id="chatbotMessages">
            <div class="chat-message bot">
                <div class="message-avatar">ü§ñ</div>
                <div class="message-content">
                    Hello! I'm your GenAI assistant. How can I help you with sentiment analysis today?
                </div>
            </div>
        </div>
        <div class="chatbot-input">
            <input type="text" id="chatInput" placeholder="Ihre Nachricht...">
            <button id="chatSend">Senden</button>
        </div>
    </div>

    <script>
        // Form handling
        const form = document.getElementById('analysisForm');
        const searchMethodSelect = document.getElementById('searchMethod');
        const urlInputGroup = document.getElementById('urlInputGroup');
        const keywordsInputGroup = document.getElementById('keywordsInputGroup');
        const submitBtn = document.getElementById('submitBtn');
        
        // Modal elements
        const analysisModal = document.getElementById('analysisModal');
        const modalClose = document.getElementById('modalClose');
        const modalProgressFill = document.getElementById('modalProgressFill');
        const modalStatus = document.getElementById('modalStatus');
        const modalProgress = document.getElementById('modalProgress');
        const resultsSummary = document.getElementById('resultsSummary');
        const newAnalysisBtn = document.getElementById('newAnalysisBtn');
        const downloadPdfBtn = document.getElementById('downloadPdfBtn');
        
        let currentJobId = null;

        // Toggle input fields based on search method
        searchMethodSelect.addEventListener('change', function() {
            urlInputGroup.style.display = this.value === 'url' ? 'block' : 'none';
            keywordsInputGroup.style.display = this.value === 'keywords' ? 'block' : 'none';
        });

        // Email validation helper
        function validateEmails(emailString) {
            const emailPattern = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
            const emails = emailString.split(',').map(e => e.trim());
            const invalidEmails = emails.filter(email => !emailPattern.test(email));
            
            if (invalidEmails.length > 0) {
                return { valid: false, invalid: invalidEmails };
            }
            return { valid: true, emails: emails };
        }

        // Form submission
        form.addEventListener('submit', async function(e) {
            e.preventDefault();
            
            // Validate email addresses
            const emailInput = document.getElementById('email').value;
            const emailValidation = validateEmails(emailInput);
            
            if (!emailValidation.valid) {
                alert('‚ùå Ung√ºltige E-Mail-Adresse(n):\n' + emailValidation.invalid.join('\n'));
                return;
            }
            
            const formData = {
                email: emailInput,  // Keep as comma-separated string - backend handles it
                customPrompt: document.getElementById('customPrompt').value || null,
                searchMethod: document.getElementById('searchMethod').value
            };

            if (formData.searchMethod === 'url') {
                formData.url = document.getElementById('targetUrl').value;
            } else if (formData.searchMethod === 'keywords') {
                formData.url = document.getElementById('keywords').value;  // Use 'url' field for keywords too
            } else if (formData.searchMethod === 'demo') {
                formData.url = 'demo';
            }

            // Show modal
            analysisModal.classList.add('active');
            modalProgress.style.display = 'block';
            resultsSummary.style.display = 'none';
            modalProgressFill.style.width = '0%';
            modalProgressFill.textContent = '0%';
            modalStatus.textContent = 'Initialisierung...';
            submitBtn.disabled = true;
            submitBtn.textContent = '‚è≥ Analyse l√§uft...';

            try {
                // Submit analysis request
                console.log('üîç Submitting analysis with data:', formData);
                const response = await fetch('http://localhost:5001/api/sentiment/analyze', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(formData)
                });

                console.log('üîç Response status:', response.status);
                
                if (!response.ok) {
                    const errorText = await response.text();
                    console.error('‚ùå API Error:', errorText);
                    throw new Error(`API returned ${response.status}: ${errorText}`);
                }

                const data = await response.json();
                console.log('üîç Response data:', data);
                
                if (!data.job_id) {
                    console.error('‚ùå No job_id in response!', data);
                    throw new Error('No job_id received from server');
                }
                
                currentJobId = data.job_id;
                console.log('‚úÖ Job ID:', currentJobId);
                
                // Store job_id for chatbot
                localStorage.setItem('recentJobId', currentJobId);

                // Poll for progress
                const pollInterval = setInterval(async () => {
                    const statusResponse = await fetch(`http://localhost:5001/api/sentiment/status/${currentJobId}`);
                    const statusData = await statusResponse.json();

                    const progress = Math.round(statusData.progress);
                    modalProgressFill.style.width = progress + '%';
                    modalProgressFill.textContent = progress + '%';
                    modalStatus.textContent = statusData.message;

                    if (statusData.status === 'completed') {
                        clearInterval(pollInterval);
                        
                        // Fetch sentiment summary
                        try {
                            const resultsResponse = await fetch(`http://localhost:5001/api/sentiment/results/${currentJobId}/data`);
                            const resultsData = await resultsResponse.json();
                            
                            console.log('Results data:', resultsData); // Debug log
                            console.log("üîç DEBUG: Fetching results for job:", currentJobId);
                            // Use statistics from performance_summary.json if available
                            console.log("üìä DEBUG: Full API Response:", JSON.stringify(resultsData, null, 2));
                            
                            if (resultsData.statistics) {
                                // Primary source: performance_summary.json
                                totalPositive = resultsData.statistics.positive || 0;
                                totalNegative = resultsData.statistics.negative || 0;
                                totalNeutral = resultsData.statistics.neutral || 0;
                                totalReviews = resultsData.statistics.total_reviews || 0;
                            } else {
                                // Fallback: sentiment_trends.json summary
                                const trendsData = resultsData.trends || {};
                                const summary = trendsData.summary || {};
                                totalPositive = summary.total_positive || 0;
                                totalNegative = summary.total_negative || 0;
                                totalNeutral = summary.total_neutral || 0;
                                totalReviews = summary.total_reviews || 0;
                            }
                            
                            console.log('Counts:', { totalPositive, totalNegative, totalNeutral, totalReviews }); // Debug log
                            
                            // Update UI
                            document.getElementById('positiveCount').textContent = totalPositive;
                            document.getElementById('negativeCount').textContent = totalNegative;
                            document.getElementById('neutralCount').textContent = totalNeutral;
                            
                            if (totalReviews > 0) {
                                document.getElementById('positivePercent').textContent = 
                                    Math.round((totalPositive / totalReviews) * 100) + '%';
                                document.getElementById('negativePercent').textContent = 
                                    Math.round((totalNegative / totalReviews) * 100) + '%';
                                document.getElementById('neutralPercent').textContent = 
                                    Math.round((totalNeutral / totalReviews) * 100) + '%';
                            }
                        } catch (err) {
                            console.error('Error fetching results:', err);
                        }
                        
                        // Show results summary
                        modalProgress.style.display = 'none';
                        resultsSummary.style.display = 'block';
                        
                        submitBtn.disabled = false;
                        submitBtn.textContent = 'üöÄ Analyse starten';
                        
                    } else if (statusData.status === 'failed') {
                        clearInterval(pollInterval);
                        modalStatus.textContent = '‚ùå Fehler: ' + statusData.message;
                        submitBtn.disabled = false;
                        submitBtn.textContent = 'üöÄ Analyse starten';
                    }
                }, 2000);

            } catch (error) {
                console.error('Error:', error);
                modalStatus.textContent = '‚ùå Verbindungsfehler. Bitte versuchen Sie es erneut.';
                submitBtn.disabled = false;
                submitBtn.textContent = 'üöÄ Analyse starten';
            }
        });
        
        // Modal close handler
        modalClose.addEventListener('click', () => {
            analysisModal.classList.remove('active');
        });
        
        // New analysis button
        newAnalysisBtn.addEventListener('click', () => {
            analysisModal.classList.remove('active');
            form.reset();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });
        
        // Download PDF button
        downloadPdfBtn.addEventListener('click', () => {
            if (currentJobId) {
                window.open(`http://localhost:5001/api/sentiment/results/${currentJobId}/pdf`, '_blank');
            }
        });
        
        // Chatbot functionality
        const chatbotTrigger = document.getElementById('chatbotTrigger');
        const chatbotWindow = document.getElementById('chatbotWindow');
        const chatbotClose = document.getElementById('chatbotClose');
        const chatInput = document.getElementById('chatInput');
        const chatSend = document.getElementById('chatSend');
        const chatbotMessages = document.getElementById('chatbotMessages');
        
        chatbotTrigger.addEventListener('click', () => {
            chatbotWindow.classList.toggle('active');
        });
        
        chatbotClose.addEventListener('click', () => {
            chatbotWindow.classList.remove('active');
        });
        
        function addMessage(text, isUser = false) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `chat-message ${isUser ? 'user' : 'bot'}`;
            
            const avatar = document.createElement('div');
            avatar.className = 'message-avatar';
            avatar.textContent = isUser ? 'üë§' : 'ü§ñ';
            
            const content = document.createElement('div');
            content.className = 'message-content';
            content.textContent = text;
            
            messageDiv.appendChild(avatar);
            messageDiv.appendChild(content);
            chatbotMessages.appendChild(messageDiv);
            chatbotMessages.scrollTop = chatbotMessages.scrollHeight;
        }
        
        function getBotResponse(userMessage) {
            // This is now just a fallback - real responses come from backend
            return 'Let me think about that... ü§î';
        }
        
        async function sendMessage() {
            const message = chatInput.value.trim();
            if (!message) return;
            
            addMessage(message, true);
            chatInput.value = '';
            
            // Check if we have a job_id from recent analysis
            const recentJobId = localStorage.getItem('recentJobId');
            
            if (recentJobId) {
                // Use backend chatbot with analysis context
                try {
                    const response = await fetch(`http://localhost:5001/api/sentiment/results/${recentJobId}/chat`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({ question: message })
                    });
                    
                    if (response.ok) {
                        const data = await response.json();
                        addMessage(data.answer, false);
                    } else {
                        // Fallback to simple responses
                        addMessage(getSimpleBotResponse(message), false);
                    }
                } catch (error) {
                    console.error('Chat error:', error);
                    addMessage(getSimpleBotResponse(message), false);
                }
            } else {
                // No analysis yet, use simple responses
                setTimeout(() => {
                    addMessage(getSimpleBotResponse(message), false);
                }, 500);
            }
        }
        
        function getSimpleBotResponse(userMessage) {
            const msg = userMessage.toLowerCase().trim();
            
            // Greetings
            if (msg.includes('hello') || msg.includes('hi') || msg === 'hi' || msg.includes('hey')) {
                return 'Hello! üëã I\'m your GenAI assistant. Run an analysis first, then I can answer detailed questions about your results. Or ask me about platform features!';
            }
            
            // Features
            if (msg.includes('feature') || msg.includes('what can')) {
                return 'Our platform offers: üß† DistilBERT Sentiment Analysis, üìä K-means Clustering, ü§ñ LLaMA Summaries, üí∞ Risk Assessment, üìÑ PDF Reports, and ‚úâÔ∏è Email Delivery!';
            }
            
            // Creator
            if (msg.includes('who built') || msg.includes('developer') || msg.includes('created') || (msg.includes('when') && msg.includes('build'))) {
                return 'Built by Andrey Vlasenko in 2025 for red6 enterprise software. Uses DistilBERT, LLaMA 3.1, and Docker. üë®‚Äçüíª';
            }
            
            // Identity
            if (msg.includes('who are you') || msg.includes('what are you')) {
                return 'I\'m an AI assistant! Once you run an analysis, I become much smarter - I can answer specific questions about your sentiment data using RAG over your results. ü§ñ';
            }
            
            // How to use
            if (msg.includes('how') && (msg.includes('start') || msg.includes('use'))) {
                return 'Fill out the form above, choose Demo mode or enter your own data, then submit! You\'ll get a PDF report via email in 2-5 minutes. ‚ö°';
            }
            
            // Default
            return 'Interesting question! ü§î Run an analysis first, then I can give you detailed insights about your sentiment data. Or ask me about platform features!';
        }
        
        chatSend.addEventListener('click', sendMessage);
        chatInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });
    </script>
</body>
</html>
